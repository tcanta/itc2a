
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>TP : Classification de tableaux &#8212; Informatique de Tonc Commun 2A La Martin</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tp/data_science/monet_jpg/tp-kmeans-monet';</script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="TD: Quantification et k-moyennes" href="../../../td/data_science/quantification-kmeans.html" />
    <link rel="prev" title="TP : Classification de voitures" href="../tp_voitures.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt="Informatique de Tonc Commun 2A La Martin - Home"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt="Informatique de Tonc Commun 2A La Martin - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Informatique de Tronc Commun spé
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Résumés de Cours</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../resume/resume.html">Résumés de Cours</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Révisions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../tp_revisions.html">TP: Révisions de 1ère année</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Structures de Données</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../cours/dict/cours_structures.html">Cours: Dictionnaires et ensembles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../td/dict/dict_polynome.html">TD: Polynôme et dictionnaire</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tp_structures.html">TP: Dictionnaires</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Paradigmes Algorithmiques</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../cours/prog_dyn/cours_prog_dyn.html">Cours: Paradigmes Algorithmiques</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../td/prog_dyn/chemin.html">TD: Chemin dans matrice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../prog_dyn/tp1_prog_dyn.html">TP 1 - Programmation Dynamique</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../prog_dyn/tp2_sac_dos.html">TP 2 - Knapsack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dm/dm1_psi-pc_LIS.html">DM 1 PSI*/PC*: LIS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Science des Données</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../cours/data_science/cours_data_science.html">Cours: Science des Données</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cours/data_science/cours_knn.html">Cours: K plus proches voisins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cours/data_science/cours_kmeans.html">Cours: Algorithme des k-moyennes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tp_titanic.html">TP KNN : Classification des survivants du Titanic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tp_voitures.html">TP : Classification de voitures</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">TP : Classification de tableaux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../td/data_science/quantification-kmeans.html">TD: Quantification et k-moyennes</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/tcanta/itc2a" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/tcanta/itc2a/issues/new?title=Issue%20on%20page%20%2Ftp/data_science/monet_jpg/tp-kmeans-monet.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/tp/data_science/monet_jpg/tp-kmeans-monet.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>TP : Classification de tableaux</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#redimensionner-les-images">Redimensionner les images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithmes-des-k-moyennes">Algorithmes des <span class="math notranslate nohighlight">\(k\)</span>-moyennes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calcul-de-l-inertie">Calcul de l’inertie</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choix-de-la-valeur-de-k">Choix de la valeur de k</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#amelioration-de-la-fonction-crop">Amélioration de la fonction crop</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tp-classification-de-tableaux">
<h1>TP : Classification de tableaux<a class="headerlink" href="#tp-classification-de-tableaux" title="Link to this heading">#</a></h1>
<hr class="docutils" />
<center><img src=https://upload.wikimedia.org/wikipedia/commons/thumb/0/05/Claude_Monet_038.jpg/1920px-Claude_Monet_038.jpg width=800></center>
<p>Dans ce TP, nous voulons classifier des tableaux de Claude Monet en utilisant l’algorithme des k-moyennes.</p>
<p>Le volume de données étant relativement important, je vous invite à travailler en local sur vos machines.
Commençons par télécharger les données <a href="https://github.com/tcanta/itc2a/raw/refs/heads/master/tp/data_science/monet_jpg/monet.zip">ici</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;*.jpg&#39;</span> 
<span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="c1"># Using List Comprehension to read all images</span>
<span class="c1">#images = np.array([plt.imread(image) for image in glob.glob(file)])</span>
<span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image</span><span class="p">)</span> <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">file</span><span class="p">)]</span>

<span class="n">digits_matrix</span> <span class="o">=</span> <span class="n">images</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">digits_matrix</span></code> est une liste contenant tous nos tableaux de Monet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># la 1ère matrice</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[ 45,  98, 148],
        [ 24,  77, 127],
        [ 69, 120, 173],
        ...,
        [ 44,  62,  50],
        [110, 114,  87],
        [ 77,  77,  41]],

       [[ 63, 116, 170],
        [ 25,  78, 132],
        [ 39,  90, 147],
        ...,
        [128, 142, 142],
        [169, 173, 156],
        [128, 126, 101]],

       [[ 59, 113, 173],
        [ 38,  92, 152],
        [ 41,  92, 155],
        ...,
        [103, 114, 132],
        [137, 138, 143],
        [125, 121, 118]],

       ...,

       [[124, 142, 142],
        [147, 165, 165],
        [162, 181, 179],
        ...,
        [160, 150, 123],
        [179, 170, 141],
        [ 98,  89,  58]],

       [[162, 168, 130],
        [170, 176, 142],
        [179, 183, 158],
        ...,
        [144, 134, 107],
        [157, 148, 119],
        [ 90,  81,  50]],

       [[113, 112,  55],
        [125, 123,  72],
        [103, 101,  63],
        ...,
        [119, 109,  82],
        [157, 148, 119],
        [ 64,  55,  24]]], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<p>Chacune de ces matrices est en fait une image au format .jpg contenant chaque pixel d’un tableau de Monet.<br />
Chaque élément de la matrice représente un pixel coloré représenté par trois valeurs entières entre 0 et 255 : le niveau de rouge, vert et bleu.
Par exemple, affichons l’image correspondant à la matrice 160 :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">digits_matrix</span><span class="p">[</span><span class="mi">161</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/7468a5d7ba04acb1a82036e9ea450d437927c6fadc8552d3d198d4e439ff6dd4.png" src="../../../_images/7468a5d7ba04acb1a82036e9ea450d437927c6fadc8552d3d198d4e439ff6dd4.png" />
</div>
</div>
<section id="redimensionner-les-images">
<h2>Redimensionner les images<a class="headerlink" href="#redimensionner-les-images" title="Link to this heading">#</a></h2>
<p>Nous avons tout d’abord besoin de redimensionner nos images à la même taille.
Une manière simple de s’y prendre consiste à couper nos images, de sorte que la taille finale de chacune corresponde à la hauteur minimale parmi les images du jeu de données par la largeur minimale trouvée.</p>
<p><strong>Question</strong> : Définir une fonction <code class="docutils literal notranslate"><span class="pre">crop_to_min</span></code> standardisant la taille des images.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">crop_to_min</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
    <span class="c1">#recherche de minimums</span>
    <span class="n">h_min</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">l_min</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">h_min</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
            <span class="n">h_min</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">l_min</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">l_min</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">h_min</span><span class="p">,</span> <span class="n">l_min</span><span class="p">)</span>
    <span class="c1">#Découpage des images</span>
    <span class="n">l</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">[:</span><span class="n">h_min</span><span class="p">,:</span><span class="n">l_min</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">l</span>

<span class="n">digits_matrix</span> <span class="o">=</span> <span class="n">crop_to_min</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">digits_matrix</span><span class="p">[</span><span class="mi">161</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>256 256
</pre></div>
</div>
<img alt="../../../_images/509760bf4d7e153dc19ab45244ec4805c57ec4652843f7ce0e4095a4aa466616.png" src="../../../_images/509760bf4d7e153dc19ab45244ec4805c57ec4652843f7ce0e4095a4aa466616.png" />
</div>
</div>
<p>Pour appliquer l’algorithme des <span class="math notranslate nohighlight">\(k\)</span>-moyennes, il faut que les données soient des vecteurs. On transforme donc une matrice en vecteur en concaténant les lignes de la matrice :<br />
$<span class="math notranslate nohighlight">\(
\begin{pmatrix}
1 &amp; 2 &amp; 3 \\
4 &amp; 5 &amp; 6 \\
7 &amp; 8 &amp; 9
\end{pmatrix}
\longrightarrow
\begin{pmatrix}
1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 &amp; 9
\end{pmatrix}
\)</span>$</p>
<p><strong>Question</strong> : Écrire une fonction <code class="docutils literal notranslate"><span class="pre">to_vector(m)</span></code> qui prend en argument une matrice <code class="docutils literal notranslate"><span class="pre">m</span></code> et renvoie le vecteur correspondant, sous forme de liste.</p>
<div class="cell tag_cor docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">to_vector</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
            <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">v</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">to_vector</span><span class="p">(</span><span class="n">digits_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">to_vector</span><span class="p">(</span><span class="n">digits_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">digits_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">digits_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># les images 256*256*3 sont transformées en vecteur 65536*3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>65536
</pre></div>
</div>
</div>
</div>
<p><strong>Question</strong> : Écrire une fonction <code class="docutils literal notranslate"><span class="pre">to_matrix(v)</span></code> qui prend en argument un vecteur <code class="docutils literal notranslate"><span class="pre">v</span></code> et renvoie la matrice correspondante, sous forme de liste de listes. On suppose que la matrice est carrée.</p>
<div class="cell tag_cor docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">to_matrix</span><span class="p">(</span><span class="n">vector</span><span class="p">):</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">):</span>
            <span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">vector</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">256</span><span class="o">+</span><span class="n">j</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">mat</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="p">(</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">to_vector</span><span class="p">(</span><span class="n">digits_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">==</span> <span class="n">digits_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> 
<span class="c1"># to_matrix et to_vector sont inverses l&#39;une de l&#39;autre</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Question</strong> : Définir une liste <code class="docutils literal notranslate"><span class="pre">X</span></code> contenant les vecteurs correspondant aux images dans <code class="docutils literal notranslate"><span class="pre">digits_matrix</span></code>. Cette variable <code class="docutils literal notranslate"><span class="pre">X</span></code> sera utilisée dans toute la suite.</p>
<div class="cell tag_cor docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">digits_matrix</span><span class="p">)):</span>
    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">to_vector</span><span class="p">(</span><span class="n">digits_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="algorithmes-des-k-moyennes">
<h2>Algorithmes des <span class="math notranslate nohighlight">\(k\)</span>-moyennes<a class="headerlink" href="#algorithmes-des-k-moyennes" title="Link to this heading">#</a></h2>
<p><strong>Question</strong> : Écrire une fonction <code class="docutils literal notranslate"><span class="pre">d(u,</span> <span class="pre">v)</span></code> qui prend en argument deux images <code class="docutils literal notranslate"><span class="pre">u</span></code> et <code class="docutils literal notranslate"><span class="pre">v</span></code> et renvoie la distance euclidienne entre ces deux vecteurs. On considerera ici que la distance entre deux images est la somme des distances entre les composantes rouges, vertes et bleues de ces images.</p>
<div class="cell tag_cor docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">d</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)):</span>
        <span class="n">r</span> <span class="o">+=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">g</span> <span class="o">+=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">b</span> <span class="o">+=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">**</span><span class="mf">.5</span> <span class="o">+</span> <span class="n">g</span><span class="o">**</span><span class="mf">.5</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mf">.5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(68997.31031030507)
</pre></div>
</div>
</div>
</div>
<p>Comme dans le cours, nous utilisons une liste <code class="docutils literal notranslate"><span class="pre">centres</span></code> pour stocker les centres des classes. <code class="docutils literal notranslate"><span class="pre">centres[i]</span></code> est le centre de la classe <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p><strong>Question</strong> : Écrire une fonction <code class="docutils literal notranslate"><span class="pre">centres_aléatoires(X,</span> <span class="pre">k)</span></code> qui prend en argument une liste de vecteurs <code class="docutils literal notranslate"><span class="pre">X</span></code> et un entier <code class="docutils literal notranslate"><span class="pre">k</span></code> et renvoie une liste de <code class="docutils literal notranslate"><span class="pre">k</span></code> vecteurs aléatoires choisis dans <code class="docutils literal notranslate"><span class="pre">X</span></code>.<br />
On utilisera <code class="docutils literal notranslate"><span class="pre">random.sample</span></code> dont <a class="reference external" href="https://docs.python.org/3/library/random.html">on pourra consulter la documentation ici</a>. On pourra préalablement utiliser <code class="docutils literal notranslate"><span class="pre">random.seed(0)</span></code> pour avoir les mêmes résultats que le corrigé du TP.</p>
<div class="cell tag_cor docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># pour avoir toujours les mêmes résultats</span>
<span class="k">def</span> <span class="nf">centres_aléatoires</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">centres</span> <span class="o">=</span> <span class="n">centres_aléatoires</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">centres</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Question</strong> : Écrire une fonction <code class="docutils literal notranslate"><span class="pre">plus_proche(x,</span> <span class="pre">centres)</span></code> qui prend en argument un vecteur <code class="docutils literal notranslate"><span class="pre">x</span></code> et une liste de vecteurs <code class="docutils literal notranslate"><span class="pre">centres</span></code> et renvoie l’indice du centre le plus proche de <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<div class="cell tag_cor docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plus_proche</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">centres</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">centres</span><span class="p">)),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">centres</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plus_proche</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">centres</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<p>Contrairement à ce qui a été fait dans le cours, on utilise dans la suite une liste <code class="docutils literal notranslate"><span class="pre">classes</span></code> telle que <code class="docutils literal notranslate"><span class="pre">classes[i]</span></code> est le numéro de classe de <code class="docutils literal notranslate"><span class="pre">X[i]</span></code> (dans le cours, <code class="docutils literal notranslate"><span class="pre">classes[i]</span></code> était la liste des vecteurs de la classe <span class="math notranslate nohighlight">\(i\)</span>).</p>
<p><strong>Question</strong> : Écrire une fonction <code class="docutils literal notranslate"><span class="pre">calculer_classes(X,</span> <span class="pre">centres)</span></code> qui renvoie la liste <code class="docutils literal notranslate"><span class="pre">classes</span></code> correspondant à <code class="docutils literal notranslate"><span class="pre">X</span></code> et à <code class="docutils literal notranslate"><span class="pre">centres</span></code>. Il faut donc que <code class="docutils literal notranslate"><span class="pre">classes[i]</span></code> soit l’indice du centre (dans <code class="docutils literal notranslate"><span class="pre">centres</span></code>) le plus proche de <code class="docutils literal notranslate"><span class="pre">X[i]</span></code>.</p>
<div class="cell tag_cor docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculer_classes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centres</span><span class="p">):</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
        <span class="n">classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plus_proche</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">centres</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">classes</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classes</span> <span class="o">=</span> <span class="n">calculer_classes</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">20</span><span class="p">],</span> <span class="n">centres_aléatoires</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">20</span><span class="p">],</span> <span class="mi">5</span><span class="p">))</span>
<span class="c1">#assert len(classes) == len(X) and max(classes) &lt; 10 and min(classes) &gt;= 0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2, 4, 4, 0, 0, 0, 0, 0, 0, 2, 0, 4, 1, 0, 0, 0, 2, 0, 0, 3]
</pre></div>
</div>
</div>
</div>
<p><strong>Question</strong> : Écrire une fonction <code class="docutils literal notranslate"><span class="pre">centre(X,</span> <span class="pre">classes,</span> <span class="pre">i)</span></code> qui renvoie le centre de la classe <span class="math notranslate nohighlight">\(i\)</span>.</p>
<div class="cell tag_cor docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">centre</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">c</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">classes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                    <span class="n">c</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">n</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">c</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">c</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">centre</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">20</span><span class="p">],</span> <span class="n">classes</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/c1f49e3392d77ab879fd73f5cfa3e1df7d111d759cc3e43af3f8e2e1d6483b11.png" src="../../../_images/c1f49e3392d77ab879fd73f5cfa3e1df7d111d759cc3e43af3f8e2e1d6483b11.png" />
</div>
</div>
<p><strong>Question</strong> : Écrire une fonction <code class="docutils literal notranslate"><span class="pre">calculer_centres(X,</span> <span class="pre">classes,</span> <span class="pre">k)</span></code> qui renvoie la liste <code class="docutils literal notranslate"><span class="pre">centres</span></code> correspondant à <code class="docutils literal notranslate"><span class="pre">X</span></code> et à <code class="docutils literal notranslate"><span class="pre">classes</span></code>.</p>
<div class="cell tag_cor docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculer_centres</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">centres</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="n">centres</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">centre</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">centres</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#classes = calculer_classes(X[:20], centres_aléatoires(X, 5))</span>
<span class="n">centres</span> <span class="o">=</span> <span class="n">calculer_centres</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">20</span><span class="p">],</span> <span class="n">classes</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">centres</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">centres</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">centres</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">centres</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">centres</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/0fb832395372852a9aa305add8da82fb19d9dd53d339a05dc1d71abe617b9ef6.png" src="../../../_images/0fb832395372852a9aa305add8da82fb19d9dd53d339a05dc1d71abe617b9ef6.png" />
<img alt="../../../_images/aeebb2caec3e21dfd2061e951b56c69fdb9d7dff74cd4aa8061eb57cfd6c434a.png" src="../../../_images/aeebb2caec3e21dfd2061e951b56c69fdb9d7dff74cd4aa8061eb57cfd6c434a.png" />
<img alt="../../../_images/c1f49e3392d77ab879fd73f5cfa3e1df7d111d759cc3e43af3f8e2e1d6483b11.png" src="../../../_images/c1f49e3392d77ab879fd73f5cfa3e1df7d111d759cc3e43af3f8e2e1d6483b11.png" />
<img alt="../../../_images/0b07e353aaa828038c2075f581c995550af2b715fd38e84544e0c9bc2be24387.png" src="../../../_images/0b07e353aaa828038c2075f581c995550af2b715fd38e84544e0c9bc2be24387.png" />
<img alt="../../../_images/e367b3a80f02f7a679ef68e9afb64fabc99cb56bf79556a43faae9dca639c653.png" src="../../../_images/e367b3a80f02f7a679ef68e9afb64fabc99cb56bf79556a43faae9dca639c653.png" />
</div>
</div>
<p><strong>Question</strong> : Écrire une fonction <code class="docutils literal notranslate"><span class="pre">kmeans(X,</span> <span class="pre">centres,</span> <span class="pre">k)</span></code> qui, à partir de centres initiaux donnés en argument, applique l’algorithme des <span class="math notranslate nohighlight">\(k\)</span>-moyennes et renvoie un couple correspondant à la liste <code class="docutils literal notranslate"><span class="pre">(centres,</span> <span class="pre">classes)</span></code> obtenue à la fin de l’algorithme.</p>
<div class="cell tag_cor docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">kmeans</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centres</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="n">calculer_classes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centres</span><span class="p">)</span>
    <span class="n">centres</span> <span class="o">=</span> <span class="n">calculer_centres</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">classes</span> <span class="o">!=</span> <span class="n">calculer_classes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centres</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centres</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">centres</span><span class="p">,</span> <span class="n">classes</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">centres</span><span class="p">,</span> <span class="n">classes</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">20</span><span class="p">],</span> <span class="n">centres_aléatoires</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span> <span class="c1"># ceci prend quelques secondes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">center</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">centres</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">center</span><span class="p">)))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">5</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">centres</span><span class="p">,</span> <span class="n">classes</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">20</span><span class="p">],</span> <span class="n">centres_aléatoires</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span> <span class="c1"># ceci prend quelques secondes</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">center</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">centres</span><span class="p">):</span>

<span class="nn">Cell In[23], line 4,</span> in <span class="ni">kmeans</span><span class="nt">(X, centres, k)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">classes</span> <span class="o">=</span> <span class="n">calculer_classes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centres</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">centres</span> <span class="o">=</span> <span class="n">calculer_centres</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="k">if</span> <span class="n">classes</span> <span class="o">!=</span> <span class="n">calculer_classes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centres</span><span class="p">):</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="k">return</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centres</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="k">return</span> <span class="n">centres</span><span class="p">,</span> <span class="n">classes</span>

<span class="nn">Cell In[16], line 4,</span> in <span class="ni">calculer_classes</span><span class="nt">(X, centres)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">classes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
<span class="ne">----&gt; </span><span class="mi">4</span>     <span class="n">classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plus_proche</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">centres</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="k">return</span> <span class="n">classes</span>

<span class="nn">Cell In[14], line 2,</span> in <span class="ni">plus_proche</span><span class="nt">(x, centres)</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="k">def</span> <span class="nf">plus_proche</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">centres</span><span class="p">):</span>
<span class="ne">----&gt; </span><span class="mi">2</span>     <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">centres</span><span class="p">)),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">centres</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="nn">Cell In[14], line 2,</span> in <span class="ni">plus_proche.&lt;locals&gt;.&lt;lambda&gt;</span><span class="nt">(i)</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="k">def</span> <span class="nf">plus_proche</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">centres</span><span class="p">):</span>
<span class="ne">----&gt; </span><span class="mi">2</span>     <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">centres</span><span class="p">)),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">centres</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="nn">Cell In[10], line 6,</span> in <span class="ni">d</span><span class="nt">(u, v)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)):</span>
<span class="ne">----&gt; </span><span class="mi">6</span>     <span class="n">r</span> <span class="o">+=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="n">g</span> <span class="o">+=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>     <span class="n">b</span> <span class="o">+=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
</section>
<section id="calcul-de-l-inertie">
<h2>Calcul de l’inertie<a class="headerlink" href="#calcul-de-l-inertie" title="Link to this heading">#</a></h2>
<p>Dans cette partie, on réutilise les listes <code class="docutils literal notranslate"><span class="pre">centres</span></code> et <code class="docutils literal notranslate"><span class="pre">classes</span></code> obtenues précédemment par un appel à <code class="docutils literal notranslate"><span class="pre">kmeans</span></code>.</p>
<p><strong>Question</strong> : Écrire une fonction <code class="docutils literal notranslate"><span class="pre">inertie(X,</span> <span class="pre">centres,</span> <span class="pre">classes)</span></code> qui renvoie l’inertie de la partition définie par <code class="docutils literal notranslate"><span class="pre">classes</span></code>. On rappelle que l’inertie d’une partition est la somme des distances au carré des points à leur centre de classe.</p>
<div class="cell tag_cor docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">inertie</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centres</span><span class="p">,</span> <span class="n">classes</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">d</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">centres</span><span class="p">[</span><span class="n">classes</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">s</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inertie</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">20</span><span class="p">],</span> <span class="n">centres</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22258872150.370857
</pre></div>
</div>
</div>
</div>
<p><strong>Question</strong> : Réécrire la fonction <code class="docutils literal notranslate"><span class="pre">kmeans</span></code> précédente de façon à ce qu’elle renvoie aussi la liste des inerties obtenues à chaque itération de l’algorithme. Utiliser le code ci-dessous pour afficher aussi l’évolution de l’inertie au cours des itérations. Commenter.</p>
<div class="cell tag_cor docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="k">def</span> <span class="nf">kmeans</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centres</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">inerties</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">centres2</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">centres</span><span class="p">)</span>
    <span class="n">centres2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">257</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">centres</span> <span class="p">,</span><span class="n">centres2</span><span class="p">):</span>
        <span class="n">centres2</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">centres</span><span class="p">)</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="n">calculer_classes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centres2</span><span class="p">)</span>
        <span class="n">centres</span> <span class="o">=</span> <span class="n">calculer_centres</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
        <span class="n">inerties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inertie</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centres</span><span class="p">,</span> <span class="n">classes</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">centres</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">inerties</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span><span class="o">=</span><span class="mi">5</span>
<span class="n">centres</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">inerties</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">20</span><span class="p">],</span> <span class="n">centres_aléatoires</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span> <span class="c1"># ceci prend quelques minutes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">inerties</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/b55a427d40e4d2abafe0836c8b901145a71011e9e3a694169763213fa3eb535d.png" src="../../../_images/b55a427d40e4d2abafe0836c8b901145a71011e9e3a694169763213fa3eb535d.png" />
</div>
</div>
</section>
<section id="choix-de-la-valeur-de-k">
<h2>Choix de la valeur de k<a class="headerlink" href="#choix-de-la-valeur-de-k" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span><span class="o">=</span><span class="mi">5</span>
<span class="n">inerties</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">centres</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">20</span><span class="p">],</span> <span class="n">centres_aléatoires</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span> <span class="c1"># ceci prend quelques minutes</span>
    <span class="n">inerties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/20fcb960740d155ec66163c3419ce4ffedefb989e8660963f7b6038c250a9b71.png" src="../../../_images/20fcb960740d155ec66163c3419ce4ffedefb989e8660963f7b6038c250a9b71.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="n">inerties</span><span class="p">[:</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7d07493c98b0&gt;]
</pre></div>
</div>
<img alt="../../../_images/961c6d9dd50fee8932799003af6fb07848263daa9c03492ab781e69789f3f09e.png" src="../../../_images/961c6d9dd50fee8932799003af6fb07848263daa9c03492ab781e69789f3f09e.png" />
</div>
</div>
<p><strong>Question</strong> : Quelle valeur de k à l’air pertinente pour notre echantillon de tableaux ?</p>
</section>
<section id="amelioration-de-la-fonction-crop">
<h2>Amélioration de la fonction crop<a class="headerlink" href="#amelioration-de-la-fonction-crop" title="Link to this heading">#</a></h2>
<p>Précédement, nous avions utilisé une fonction qui découpait les images trop grandes en ne gardant que les pixels correspondant au rectangle en haut à gauche de l’image.</p>
<p><strong>Question</strong> : Proposer une amélioration de la fonction crop qui prenne mieux en compte l’image dans sa globalité.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./tp/data_science/monet_jpg"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../tp_voitures.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">TP : Classification de voitures</p>
      </div>
    </a>
    <a class="right-next"
       href="../../../td/data_science/quantification-kmeans.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">TD: Quantification et k-moyennes</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#redimensionner-les-images">Redimensionner les images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithmes-des-k-moyennes">Algorithmes des <span class="math notranslate nohighlight">\(k\)</span>-moyennes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calcul-de-l-inertie">Calcul de l’inertie</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choix-de-la-valeur-de-k">Choix de la valeur de k</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#amelioration-de-la-fonction-crop">Amélioration de la fonction crop</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Thibaut Cantaluppi
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>